{{/* Slack Templates for FastFood Delivery AlertManager */}}

{{/* Default Slack Title */}}
{{ define "slack.default.title" }}
{{ if eq .Status "firing" }}ğŸ””{{ else }}âœ…{{ end }} [{{ .Status | toUpper }}] {{ .GroupLabels.alertname }}
{{ end }}

{{/* Default Slack Text */}}
{{ define "slack.default.text" }}
{{ if eq .Status "firing" }}
*Alerts Firing:* {{ .Alerts.Firing | len }}
{{ else }}
*Alerts Resolved:* {{ .Alerts.Resolved | len }}
{{ end }}

{{ range .Alerts }}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
*Summary:* {{ .Annotations.summary }}
*Description:* {{ .Annotations.description }}
{{ if .Labels.service }}*Service:* `{{ .Labels.service }}`{{ end }}
{{ if .Labels.severity }}*Severity:* {{ .Labels.severity }}{{ end }}
{{ if eq .Status "firing" }}
*Started:* {{ .StartsAt.Format "2006-01-02 15:04:05" }}
{{ else }}
*Resolved:* {{ .EndsAt.Format "2006-01-02 15:04:05" }}
{{ end }}
{{ end }}
{{ end }}

{{/* Critical Alert Slack Template */}}
{{ define "slack.critical.title" }}
ğŸš¨ CRITICAL: {{ .GroupLabels.alertname }}
{{ end }}

{{ define "slack.critical.text" }}
*IMMEDIATE ATTENTION REQUIRED*

{{ range .Alerts }}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
*Alert:* {{ .Labels.alertname }}
*Summary:* {{ .Annotations.summary }}
*Description:* {{ .Annotations.description }}
{{ if .Labels.service }}*Affected Service:* `{{ .Labels.service }}`{{ end }}
*Time:* {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
{{ end }}

<{{ .ExternalURL }}|ğŸ”— View in Alertmanager>
{{ end }}

{{/* Service Down Alert */}}
{{ define "slack.servicedown.text" }}
ğŸ”´ *SERVICE DOWN DETECTED*

{{ range .Alerts }}
*Service:* `{{ .Labels.service }}`
*Status:* {{ .Status | toUpper }}
*Details:* {{ .Annotations.description }}
{{ end }}

*Action Required:* Check service health and restart if necessary.
{{ end }}

{{/* Database Alert Template */}}
{{ define "slack.database.title" }}
ğŸ’¾ DATABASE: {{ .GroupLabels.alertname }}
{{ end }}

{{ define "slack.database.text" }}
{{ if eq .Status "firing" }}
âš ï¸ *Database Issue Detected*
{{ else }}
âœ… *Database Issue Resolved*
{{ end }}

{{ range .Alerts }}
{{ if .Labels.service }}*Database:* {{ .Labels.service }}{{ end }}
*Issue:* {{ .Annotations.summary }}
*Details:* {{ .Annotations.description }}
{{ end }}
{{ end }}

{{/* Resolved Alert Template */}}
{{ define "slack.resolved.text" }}
âœ… *RESOLVED*

The following alerts have been resolved:
{{ range .Alerts }}
â€¢ {{ .Labels.alertname }}{{ if .Labels.service }} ({{ .Labels.service }}){{ end }}
{{ end }}

*Resolved at:* {{ (index .Alerts 0).EndsAt.Format "2006-01-02 15:04:05 MST" }}
{{ end }}

{{/* Alert Summary for multiple alerts */}}
{{ define "slack.summary" }}
ğŸ“Š *Alert Summary*

*Status:* {{ .Status | toUpper }}
*Grouped by:* {{ .GroupLabels }}
*Total Alerts:* {{ len .Alerts }}

{{ if .Alerts.Firing }}
ğŸ”´ *Firing ({{ .Alerts.Firing | len }}):*
{{ range .Alerts.Firing }}
  â€¢ {{ .Labels.alertname }}{{ if .Labels.service }} - {{ .Labels.service }}{{ end }}
{{ end }}
{{ end }}

{{ if .Alerts.Resolved }}
âœ… *Resolved ({{ .Alerts.Resolved | len }}):*
{{ range .Alerts.Resolved }}
  â€¢ {{ .Labels.alertname }}{{ if .Labels.service }} - {{ .Labels.service }}{{ end }}
{{ end }}
{{ end }}
{{ end }}
